using VulnerabilityScanner.Service.Interfaces;
using VulnerabilityScanner.Service.Models;
using VulnerabilityScanner.Service.Models.Responses;
using DomainVulnerablePackage = VulnerabilityScanner.Models.VulnerablePackage;

namespace VulnerabilityScanner.Service.Mappers;

public class ScanResponseMapper : IMapper<IEnumerable<DomainVulnerablePackage>, ScanResponse>
{
    public ScanResponse Map(IEnumerable<DomainVulnerablePackage> input) =>
        new ScanResponse
        {
            VulnerablePackages = input.Select(x => new VulnerablePackage
            {
                Name = x.Name,
                Severity = x.Severity.ToString().ToUpper(),
                Summary = x.Summary,
                Version = x.Version.ToString(),
                FirstPatchedVersion = x.FirstPatchedVersion.ToString()
            })
        };
}
