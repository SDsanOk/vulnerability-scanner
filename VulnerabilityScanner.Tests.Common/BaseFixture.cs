using AutoFixture;
using Microsoft.Extensions.Logging;
using Moq;
using Moq.AutoMock;

namespace VulnerabilityScanner.Tests.Common;

public class BaseFixture<T> where T : class
{
    protected Fixture Fixture { get; } = new Fixture();
    protected AutoMocker Mocker { get; } = new AutoMocker(MockBehavior.Strict);
    protected T Subject => Mocker.CreateInstance<T>();

    protected void SetupLogger(LogLevel logLevel)
    {
        Mocker
            .GetMock<ILogger<T>>()
            .Setup(
            x => x.Log(
                logLevel,
                It.IsAny<EventId>(),
                It.IsAny<It.IsAnyType>(),
                It.IsAny<Exception>(),
                It.IsAny<Func<It.IsAnyType, Exception?, string>>()));
    }
}
