using VulnerabilityScanner.DataAccess.GraphQL.Constants;
using VulnerabilityScanner.DataAccess.GraphQL.Interfaces;
using VulnerabilityScanner.DataAccess.GraphQL.Models;
using VulnerabilityScanner.Models;

namespace VulnerabilityScanner.DataAccess.GraphQL;

public class GraphQlRequestFactory : IGraphQlRequestFactory
{
    public GraphQlRequest CreateSecurityVulnerableRequest(ProjectEcosystem ecosystem, string packageName)
    {
        var securityVulnerabilityRequest = new GraphQlRequest
        {
            Query = GraphQlQueries.SecurityVulnerabilitiesQuery,
            OperationName = GraphQlQueries.SecurityVulnerabilitiesOperationName,
            Variables = new
            {
                packageName = packageName,
                ecosystem = ecosystem.ToString().ToUpper()
            }
        };

        return securityVulnerabilityRequest;
    }
}
