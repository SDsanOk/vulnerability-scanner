using VulnerabilityScanner.Models;

namespace VulnerabilityScanner.DataAccess.GraphQL;

public class GraphQlRequestFactory : IGraphQlRequestFactory
{
    public GraphQlRequest CreateSecurityVulnerableRequest(ProjectEcosystem ecosystem, string packageName)
    {
        var securityVulnerabilityRequest = new GraphQlRequest
        {
            Query = GraphQlQueries.SecurityVulnerabilitiesQuery,
            OperationName = GraphQlQueries.SecurityVulnerabilitiesOperationName,
            Variables = new
            {
                packageName = packageName,
                ecosystem = ecosystem.ToString()
            }
        };

        return securityVulnerabilityRequest;
    }
}

public interface IGraphQlRequestFactory
{
    GraphQlRequest CreateSecurityVulnerableRequest(ProjectEcosystem ecosystem, string packageName);
}
