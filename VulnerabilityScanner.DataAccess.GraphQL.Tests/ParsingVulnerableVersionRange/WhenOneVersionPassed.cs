using AutoFixture.Xunit2;
using FluentAssertions;
using VulnerabilityScanner.Models.Enums;
using Xunit;

namespace VulnerabilityScanner.DataAccess.GraphQL.Tests.ParsingVulnerableVersionRange;

public class WhenOneVersionPassed : VulnerableVersionRangeParserFixture
{
    [Theory]
    [AutoData]
    public void ReturnOneCorrectVersion(EqualityOperator operatorInput, Version versionInput)
    {
        var inputString = $"{operatorInput} {versionInput}";
        WithEqualityOperator(operatorInput.ToString(), operatorInput);

        var result = Subject
            .Parse(inputString)
            .ToArray();

        result.Length.Should().Be(1);
        var firstVulnerableVersionRange = result.First();
        firstVulnerableVersionRange.Version.Should().Be(versionInput);
        firstVulnerableVersionRange.Operator.Should().Be(operatorInput);

    }
}
