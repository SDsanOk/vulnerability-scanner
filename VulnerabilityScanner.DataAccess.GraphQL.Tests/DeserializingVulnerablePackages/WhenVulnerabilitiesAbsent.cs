using FluentAssertions;
using Microsoft.Extensions.Logging;
using Xunit;

namespace VulnerabilityScanner.DataAccess.GraphQL.Tests.DeserializingVulnerablePackages;

public class WhenVulnerabilitiesAbsent : VulnerablePackagesDeserializerStrategyFixture
{
    [Fact]
    public void ReturnEmptyCollection()
    {
        SetupLogger(LogLevel.Debug);

        var result = Subject.Deserialize(GenerateVulnerabilitiesJson(null!));

        result.Should().BeEmpty();
    }
}
